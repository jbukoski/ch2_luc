na_cor <- cor(na.omit(mg2014_gn$mangrov), na.omit(mg2014_gn$nodata), method = "pearson")
lm(nodata ~ mangrov, data = mg2014_gn)
fig5 <- mg2014_gn %>%
st_set_geometry(NULL) %>%
ggplot(aes(x = mangrov / 1000, y = nodata / 1000)) +
geom_point(color = "dark grey") +
theme_tufte() +
ylab("Extent of new mangrove colonization (kha)") +
xlab("Extent of non-converted mangrove (kha)") +
stat_smooth(method = "lm", color = "red", size = 0.5, fill = "grey") +
annotate("text", x = 12.5, y = 0.1, label = "Pearson Corr. = 0.87", col = "red") +
theme(axis.title.x = element_text(family = "sans"),
axis.title.y = element_text(family = "sans"))
fig5
ggsave("./figs/fig5_nodata.jpg", fig5, width = 6, height = 5, units = c("in"), device = "jpeg")
fig5 <- mg2014_gn %>%
st_set_geometry(NULL) %>%
ggplot(aes(x = mangrov / 1000, y = nodata / 1000)) +
geom_point(color = "dark grey") +
theme_tufte() +
ylab("Extent of new mangrove colonization (kha)") +
xlab("Extent of undisturbed mangrove (kha)") +
stat_smooth(method = "lm", color = "red", size = 0.5, fill = "grey") +
annotate("text", x = 12.5, y = 0.1, label = "Pearson Corr. = 0.87", col = "red") +
theme(axis.title.x = element_text(family = "sans"),
axis.title.y = element_text(family = "sans"))
fig5
ggsave("./figs/fig5_nodata.jpg", fig5, width = 6, height = 5, units = c("in"), device = "jpeg")
mean(dstrcts_c_df$SOC_AVG, na.rm = T)
311.32 * 514.2
311.32 * 514.2 * 0.43
306.73 * 514.2 * 0.43
246 * 357.1 * 0.43
311.32 * 514.2 * 0.43
246 * 357.1
246 * 357.1 * 0.43
246 * 375.1 * 0.43
306.73 * 514.2 * 0.43
298600/39700
dat2000 <- read_csv("./data/processed/allPrdsSmry.csv") %>%
mutate(error = error * 1.96)
dat2000 <- read_csv("./data/processed/allPrdsSmry.csv") %>%
mutate(error = error * 1.96)
dat2000$year[1] <- "Pre-1960 - 2000"
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .1, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
#guides(linetype = "none", alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
dat2000$year[1] <- "pre-1960 - 2000"
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .1, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
#guides(linetype = "none", alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
dat2000$year[1] <- "~1960 - 2000"
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .1, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
#guides(linetype = "none", alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
ggsave("./figs/fig3_stocks.jpg", fig3, width = 4, height = 6, units = c("in"), device = "jpeg")
1.61 * 10 / 14
0.13 * 10 / 14
67800 / 39700
298600 / 67800
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
mg2000 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2000")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014_ls <- st_read(paste0(proc_dir, "shapefiles/dstrct_losses_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
mutate(mines = NA)
mg2014_gn <- st_read(paste0(proc_dir, "shapefiles/dstrct_gains_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014_gn %>%
st_set_geometry(NULL) %>%
ggplot() +
geom_point(aes( x= mangrov, y = nodata))
calcCarbon <- function(sf_obj, agb_rate, soc_rate, nodata = F) {
if(!("nodata" %in% colnames(sf_obj) | "water" %in% colnames(sf_obj))) {
sf_obj <- sf_obj %>%
mutate(nodata = NA, water = NA)
}
df <- sf_obj %>%
st_set_geometry(NULL) %>%
mutate(aqua_c = (aqucltr * AGB_AVG * agb_rate) + (aqucltr * SOC_AVG * soc_rate),
aqua_c_se = (aqucltr * AGB_SE * agb_rate) + (aqucltr * SOC_SE * soc_rate),
agri_c = (agrcltr * AGB_AVG * agb_rate) + (agrcltr * SOC_AVG * soc_rate),
agri_c_se = (agrcltr * AGB_SE * agb_rate) + (agrcltr * SOC_SE * soc_rate),
abnd_c = (abandnd * AGB_AVG * agb_rate) + (abandnd * SOC_AVG * soc_rate),
abnd_c_se = (abandnd * AGB_SE * agb_rate) + (abandnd * SOC_SE * soc_rate),
salt_c = (slt_frm * AGB_AVG * agb_rate) + (slt_frm * SOC_AVG * soc_rate),
salt_c_se = (slt_frm * AGB_SE * agb_rate) + (slt_frm * SOC_SE * soc_rate),
urbn_c = (urban * AGB_AVG * agb_rate) + (urban * SOC_AVG * soc_rate),
urbn_c_se = (urban * AGB_SE * agb_rate) + (urban * SOC_SE * soc_rate),
wtr_c = (water * AGB_AVG * agb_rate),
wtr_c_se = (water * AGB_SE * agb_rate),
na_c = (nodata * AGB_AVG * agb_rate) + (nodata * SOC_AVG * soc_rate),
na_c_se = (nodata * AGB_SE * agb_rate) + (nodata * SOC_SE) * soc_rate) %>%
dplyr::select(aqua_c, aqua_c_se, agri_c, agri_c_se, abnd_c, abnd_c_se,
salt_c, salt_c_se, urbn_c, urbn_c_se, na_c, na_c_se, wtr_c, wtr_c_se)
ttls <- colSums(df, na.rm = T)
ttl <- sum(ttls)
return(ttls)
}
mg2000_hls <- calcCarbon(mg2000, agb_rate = 1, soc_rate = 0.67)
mg2000_mls <- calcCarbon(mg2000, agb_rate = 0.82, soc_rate = 0.54)
mg2000_lls <- calcCarbon(mg2000, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hls <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67)
mg2014_mls <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54)
mg2014_lls <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hgn <- calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_mgn <- calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_lgn <- calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
mg2014_hls_hgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_hls_mgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_hls_lgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
mg2014_mls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_mls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_mls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
mg2014_lls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_lls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_lls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
carbonTable <- rbind(mg2000_hls, mg2000_mls, mg2000_lls,
mg2014_hls, mg2014_mls, mg2014_lls,
mg2014_hgn, mg2014_mgn, mg2014_lgn,
mg2014_hls_hgn, mg2014_hls_mgn, mg2014_hls_lgn,
mg2014_mls_hgn, mg2014_mls_mgn, mg2014_mls_lgn,
mg2014_lls_hgn, mg2014_lls_mgn, mg2014_lls_lgn) %>%
as.data.frame() %>%
mutate(year = c(rep("2000", 3), rep("2014", 15)),
loss = c(rep(c("hgh", "med", "low"), 2), rep(NA, 3), rep("hgh", 3), rep("med", 3), rep("low", 3)),
gain = c(rep(NA, 6), rep(c("hgh", "med", "low"), 4))) %>%
mutate(ttl = (aqua_c + agri_c + abnd_c + salt_c + urbn_c + na_c + wtr_c) / 1000000,
ttl_se = (aqua_c_se + agri_c_se + abnd_c_se + salt_c_se + urbn_c_se + na_c_se + wtr_c_se) / 1000000)
smryDat2000 <- carbonTable[1:9, ] %>%
dplyr::select(year, loss, gain, ttl, ttl_se)
smryDat2014 <- carbonTable[10:18, ] %>%
dplyr::select(year, loss, gain, ttl, ttl_se)
smryDat2014
5.68 / 3.65
3.65 / 5.68
calcCarbon <- function(sf_obj, agb_rate, soc_rate, nodata = F) {
if(!("nodata" %in% colnames(sf_obj) | "water" %in% colnames(sf_obj))) {
sf_obj <- sf_obj %>%
mutate(nodata = NA, water = NA)
}
df <- sf_obj %>%
st_set_geometry(NULL) %>%
mutate(aqua_c = (aqucltr * AGB_AVG * agb_rate) + (aqucltr * SOC_AVG * soc_rate),
aqua_c_se = (aqucltr * AGB_SE * agb_rate) + (aqucltr * SOC_SE * soc_rate),
agri_c = (agrcltr * AGB_AVG * agb_rate) + (agrcltr * SOC_AVG * soc_rate),
agri_c_se = (agrcltr * AGB_SE * agb_rate) + (agrcltr * SOC_SE * soc_rate),
abnd_c = (abandnd * AGB_AVG * agb_rate) + (abandnd * SOC_AVG * soc_rate),
abnd_c_se = (abandnd * AGB_SE * agb_rate) + (abandnd * SOC_SE * soc_rate),
salt_c = (slt_frm * AGB_AVG * agb_rate) + (slt_frm * SOC_AVG * soc_rate),
salt_c_se = (slt_frm * AGB_SE * agb_rate) + (slt_frm * SOC_SE * soc_rate),
urbn_c = (urban * AGB_AVG * agb_rate) + (urban * SOC_AVG * soc_rate),
urbn_c_se = (urban * AGB_SE * agb_rate) + (urban * SOC_SE * soc_rate),
wtr_c = (water * AGB_AVG * agb_rate), + (water * SOC_AVG * soc_rate),
wtr_c_se = (water * AGB_SE * agb_rate) + (water * SOC_SE * soc_rate),
na_c = (nodata * AGB_AVG * agb_rate) + (nodata * SOC_AVG * soc_rate),
na_c_se = (nodata * AGB_SE * agb_rate) + (nodata * SOC_SE) * soc_rate) %>%
dplyr::select(aqua_c, aqua_c_se, agri_c, agri_c_se, abnd_c, abnd_c_se,
salt_c, salt_c_se, urbn_c, urbn_c_se, na_c, na_c_se, wtr_c, wtr_c_se)
ttls <- colSums(df, na.rm = T)
ttl <- sum(ttls)
return(ttls)
}
mg2000_hls <- calcCarbon(mg2000, agb_rate = 1, soc_rate = 0.67)
mg2000_mls <- calcCarbon(mg2000, agb_rate = 0.82, soc_rate = 0.54)
mg2000_lls <- calcCarbon(mg2000, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hls <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67)
mg2014_mls <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54)
mg2014_lls <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hgn <- calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_mgn <- calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_lgn <- calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
mg2014_hls_hgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_hls_mgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_hls_lgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
mg2014_mls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_mls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_mls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
mg2014_lls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_lls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_lls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
carbonTable <- rbind(mg2000_hls, mg2000_mls, mg2000_lls,
mg2014_hls, mg2014_mls, mg2014_lls,
mg2014_hgn, mg2014_mgn, mg2014_lgn,
mg2014_hls_hgn, mg2014_hls_mgn, mg2014_hls_lgn,
mg2014_mls_hgn, mg2014_mls_mgn, mg2014_mls_lgn,
mg2014_lls_hgn, mg2014_lls_mgn, mg2014_lls_lgn) %>%
as.data.frame() %>%
mutate(year = c(rep("2000", 3), rep("2014", 15)),
loss = c(rep(c("hgh", "med", "low"), 2), rep(NA, 3), rep("hgh", 3), rep("med", 3), rep("low", 3)),
gain = c(rep(NA, 6), rep(c("hgh", "med", "low"), 4))) %>%
mutate(ttl = (aqua_c + agri_c + abnd_c + salt_c + urbn_c + na_c + wtr_c) / 1000000,
ttl_se = (aqua_c_se + agri_c_se + abnd_c_se + salt_c_se + urbn_c_se + na_c_se + wtr_c_se) / 1000000)
smryDat2000 <- carbonTable[1:9, ] %>%
dplyr::select(year, loss, gain, ttl, ttl_se)
smryDat2014 <- carbonTable[10:18, ] %>%
dplyr::select(year, loss, gain, ttl, ttl_se)
smryDat2014
calcCarbon <- function(sf_obj, agb_rate, soc_rate, nodata = F) {
if(!("nodata" %in% colnames(sf_obj) | "water" %in% colnames(sf_obj))) {
sf_obj <- sf_obj %>%
mutate(nodata = NA, water = NA)
}
df <- sf_obj %>%
st_set_geometry(NULL) %>%
mutate(aqua_c = (aqucltr * AGB_AVG * agb_rate) + (aqucltr * SOC_AVG * soc_rate),
aqua_c_se = (aqucltr * AGB_SE * agb_rate) + (aqucltr * SOC_SE * soc_rate),
agri_c = (agrcltr * AGB_AVG * agb_rate) + (agrcltr * SOC_AVG * soc_rate),
agri_c_se = (agrcltr * AGB_SE * agb_rate) + (agrcltr * SOC_SE * soc_rate),
abnd_c = (abandnd * AGB_AVG * agb_rate) + (abandnd * SOC_AVG * soc_rate),
abnd_c_se = (abandnd * AGB_SE * agb_rate) + (abandnd * SOC_SE * soc_rate),
salt_c = (slt_frm * AGB_AVG * agb_rate) + (slt_frm * SOC_AVG * soc_rate),
salt_c_se = (slt_frm * AGB_SE * agb_rate) + (slt_frm * SOC_SE * soc_rate),
urbn_c = (urban * AGB_AVG * agb_rate) + (urban * SOC_AVG * soc_rate),
urbn_c_se = (urban * AGB_SE * agb_rate) + (urban * SOC_SE * soc_rate),
wtr_c = (water * AGB_AVG * agb_rate) + (water * SOC_AVG * soc_rate),
wtr_c_se = (water * AGB_SE * agb_rate) + (water * SOC_SE * soc_rate),
na_c = (nodata * AGB_AVG * agb_rate) + (nodata * SOC_AVG * soc_rate),
na_c_se = (nodata * AGB_SE * agb_rate) + (nodata * SOC_SE * soc_rate)) %>%
dplyr::select(aqua_c, aqua_c_se, agri_c, agri_c_se, abnd_c, abnd_c_se,
salt_c, salt_c_se, urbn_c, urbn_c_se, na_c, na_c_se, wtr_c, wtr_c_se)
ttls <- colSums(df, na.rm = T)
ttl <- sum(ttls)
return(ttls)
}
mg2000_hls <- calcCarbon(mg2000, agb_rate = 1, soc_rate = 0.67)
mg2000_mls <- calcCarbon(mg2000, agb_rate = 0.82, soc_rate = 0.54)
mg2000_lls <- calcCarbon(mg2000, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hls <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67)
mg2014_mls <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54)
mg2014_lls <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hgn <- calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_mgn <- calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_lgn <- calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
mg2014_hls_hgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_hls_mgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_hls_lgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
mg2014_mls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_mls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_mls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
mg2014_lls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.43)
mg2014_lls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.26)
mg2014_lls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.08)
carbonTable <- rbind(mg2000_hls, mg2000_mls, mg2000_lls,
mg2014_hls, mg2014_mls, mg2014_lls,
mg2014_hgn, mg2014_mgn, mg2014_lgn,
mg2014_hls_hgn, mg2014_hls_mgn, mg2014_hls_lgn,
mg2014_mls_hgn, mg2014_mls_mgn, mg2014_mls_lgn,
mg2014_lls_hgn, mg2014_lls_mgn, mg2014_lls_lgn) %>%
as.data.frame() %>%
mutate(year = c(rep("2000", 3), rep("2014", 15)),
loss = c(rep(c("hgh", "med", "low"), 2), rep(NA, 3), rep("hgh", 3), rep("med", 3), rep("low", 3)),
gain = c(rep(NA, 6), rep(c("hgh", "med", "low"), 4))) %>%
mutate(ttl = (aqua_c + agri_c + abnd_c + salt_c + urbn_c + na_c + wtr_c) / 1000000,
ttl_se = (aqua_c_se + agri_c_se + abnd_c_se + salt_c_se + urbn_c_se + na_c_se + wtr_c_se) / 1000000)
smryDat2000 <- carbonTable[1:9, ] %>%
dplyr::select(year, loss, gain, ttl, ttl_se)
smryDat2014 <- carbonTable[10:18, ] %>%
dplyr::select(year, loss, gain, ttl, ttl_se)
smryDat2014
citation("nls")
citation("nls")
citation("nls2")
citation("propagate")
0.26 * 10/14
10/14
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
mg2014_rstrn <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
dplyr::select(ADM1_EN, ADM2_ID, ADM2_EN, aqucltr, agrcltr, abandnd,
AGB_AVG, AGB_SE, SOC_AVG, SOC_SE)
calcRestorationCarbon <- function(df, rstr_rate, agb_rate, soc_rate) {
# df <- mg2014_rstrn
# rstr_rate <- 0.01
# agb_rate <- .40
# soc_rate <- .10
df_rstr <- df %>%
mutate(aqucltr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
agb_rstr_se = total * agb_rate * AGB_SE,
soc_rstr = total * soc_rate * SOC_AVG,
soc_rstr_se = total * soc_rate * SOC_SE) %>%
dplyr::select(total, agb_rstr, agb_rstr_se, soc_rstr, soc_rstr_se)
ttls <- colSums(df_rstr, na.rm = T)
ttl <- sum(ttls[2] + ttls[4]) / 1000000
ttl_se <- sum(ttls[3] + ttls[5]) / 1000000
return(c(ttl, ttl_se))
}
agb <- 0.65  # high 65%, med 40%, low 24%
soc <- 0.43  # high 43%, med 26%, low 8%
calcRestorationCarbon(mg2014_rstrn, 0.001, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.01, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.02, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.05, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.1, agb, soc) * 10/14
agb <- 0.40  # high 65%, med 40%, low 24%
soc <- 0.26  # high 43%, med 26%, low 8%
calcRestorationCarbon(mg2014_rstrn, 0.001, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.01, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.02, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.05, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.1, agb, soc) * 10/14
agb <- 0.24  # high 65%, med 40%, low 24%
soc <- 0.08  # high 43%, med 26%, low 8%
calcRestorationCarbon(mg2014_rstrn, 0.001, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.01, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.02, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.05, agb, soc) * 10/14
calcRestorationCarbon(mg2014_rstrn, 0.1, agb, soc) * 10/14
c_dat <- read_sf("./data/processed/shapefiles/dstrcts_c/")
library(sf)
library(sf)
library(tidyverse)
c_dat <- read_sf("./data/processed/shapefiles/dstrcts_c/")
library(sf)
library(tidyverse)
dat <- read_csv("~/Desktop/restoration.csv", col_names = c("year", "lnrr"))
head(dat)
mdl1 <- glm(lnrr ~ log(year), data = filter(dat, year <= 50))
predict(year = 14, mdl1)
dat %>%
filter(year <= 50) %>%
ggplot() +
geom_point(aes(x = year, y = lnrr)) +
geom_smooth(aes(x = year, y = lnrr), method = "glm", formula = y ~ log(x))
exp(-0.077)
c_dat <- read_sf("./data/processed/shapefiles/dstrcts_c/")
c_dat <- read_sf("./data/processed/shapefiles/dstrcts_c/") %>%
st_set_geometry(NULL)
mean(c_dat$AGB_AVG)
mean(c_dat$AGB_AVG, na.rm = T)
mean(c_dat$SOC_AVG, na.rm = T)
311.3 + 54.8
366.1 * 0.92
agb * -0.82 + soc * -0.54
agb <- mean(c_dat$AGB_AVG, na.rm = T)
soc <- mean(c_dat$SOC_AVG, na.rm = T)
agb + soc
agb + soc * 0.92
agb * -0.82 + soc * -0.54
agb * 0.18 + soc * 0.46
(agb * 0.18 + soc * 0.46) + (agb * 0.65 + soc * 0.26)
(agb * 0.18 + soc * 0.46) + (agb * 0.65 + soc * 0.26) / 366.1
(agb * 0.18 + soc * 0.46) + (agb * 0.65 + soc * 0.26)
269.643 / (agb + soc)
(agb * 0.18 + soc * 0.46) + (agb * 0.65 + soc * 0.43)
269.643 / (agb + soc)
(agb * 0.18 + soc * 0.46) + (agb * 0.65 + soc * 0.43)
322.5667 / (agb + soc)
predictDat <- seq(0, max(dat$yr), by = 2)
predictDat <- seq(0, max(dat$year), by = 2)
prop1 <- predictNLS(mdl1, newdata = data.frame(year = predictDat))
library(propagate)
library(nls)
prop1 <- predictNLS(mdl1, newdata = data.frame(year = predictDat))
predictDat
prop1
prop_df <- data.frame(yr = predictDat,
prdct = prop1$summary$Prop.Mean.1,
lwr = prop1$summary$`Prop.2.5%`,
upr = prop1$summary$`Prop.97.5%`)
prop_df
?predictNLS
prop1
prop1$summary
mdl1 <- nls(lnrr ~ log(year), data = filter(dat, year <= 50))
mdl1 <- glm(lnrr ~ log(year), data = filter(dat, year <= 50), family = "log")
mdl1 <- glm(lnrr ~ log(year), data = filter(dat, year <= 50))
plot(mdl1)
predict(14, mdl1, se = TRUE)
predict.glm(14, mdl1)
predict.glm(mdl1, se.fit = T)
exp(-0.0771088)
exp(-0.0771088-0.087)
exp(-0.0771088+0.087)
dat %>%
filter(year <= 50) %>%
ggplot() +
geom_point(aes(x = year, y = lnrr)) +
geom_smooth(aes(x = year, y = lnrr), method = "glm", formula = y ~ log(x))
exp(-0.0771088+0.087*2)
exp(-0.0771088+(0.087*1.96))
exp(-0.0771088-(0.087*1.96))
54 * 0.92
library(sf)
library(tidyverse)
library(propagate)
dat <- read_csv("~/Desktop/restoration.csv", col_names = c("year", "lnrr"))
head(dat)
mdl1 <- glm(lnrr ~ log(year), data = filter(dat, year <= 50))
dat
dat %>%
#filter(year <= 50) %>%
ggplot() +
geom_point(aes(x = year, y = lnrr)) +
geom_smooth(aes(x = year, y = lnrr), method = "glm", formula = y ~ log(x))
dat <- data.frame(y = c(2, 3, 3.5, 4, 4.2, 5, 6, 7, 6, 8),
dbh = x(5, 5.1, 5.2, 5.4, 5.4, 6, 6, 6.2, 7.1, 6.2))
dat <- data.frame(y = c(2, 3, 3.5, 4, 4.2, 5, 6, 7, 6, 8),
dbh = c(5, 5.1, 5.2, 5.4, 5.4, 6, 6, 6.2, 7.1, 6.2))
plot(dat$dbh, dat$y
)
dat <- data.frame(y = c(2, 3, 3.5, 4, 4.2, 5, 6, 7, 6, 5.8),
dbh = c(5, 5.1, 5.2, 5.4, 5.4, 6, 6, 6.2, 7.1, 6.2))
plot(dat$dbh, dat$y)
dat <- data.frame(y = c(2, 3, 3.5, 4, 4.2, 5, 6, 6, 7, 6, 5.8),
dbh = c(5, 5.1, 5.2, 5.4, 5.4, 5.7, 6, 6, 6.2, 7.1, 6.2))
plot(dat$dbh, dat$y)
dat <- data.frame(y = c(2, 3, 3.5, 4, 4.2, 6.5, 6, 6, 7, 6, 5.8),
dbh = c(5, 5.1, 5.2, 5.4, 5.4, 5.7, 6, 6, 6.2, 7.1, 6.2))
plot(dat$dbh, dat$y)
plot(dat$dbh, log(dat$y, base = exp(1))
plot(dat$dbh, log(dat$y, base = exp(1)))
plot(dat$dbh, log(dat$y, base = exp(1)))
dat2 <- data.frame(y = c(1:20),
x = log(c(1:20)))
plot(dat2$x, dat2$y)
plot(dat2$y, dat2$x)
dat2 <- data.frame(y = log(c(1:20)),
x = c(1:20))
plot(dat2$y, dat2$x)
plot(dat2$x, dat2$y)
plot(dat2$x, log(dat2$y, base = exp(1)))
plot(dat2$x^-1, log(dat2$y, base = exp(1)))
plot(dat2$x^-2, log(dat2$y, base = exp(1)))
plot(dat2$x^1/2, log(dat2$y, base = exp(1)))
plot(sqrt(dat2$x), log(dat2$y, base = exp(1)))
plot(dat2$x, dat2$x)
plot(dat2$x, dat2$x^-1)
plot(dat2$x, dat2$x^-2)
plot(dat2$x, sqrt(dat2$x))
plot(dat2$x, dat2$x + dat2$x^2)
plot(dat2$x, dat2$x + dat2$x^-2)
exp((coef(mdl)[1] - 1.96 * 0.12235) + ((coef(mdl)[2] - 1.96 * 0.04912) * log(14)))
