library(sp)
library(spsurvey)
library(tidyverse)
raw_dir <- "./data/raw/"
proc_dir <- "./data/processed/"
table_dir <- "./tables/"
mg2000 <- raster(paste0(proc_dir, "rasters/mg2000.tif"))
mg2014 <- raster(paste0(proc_dir, "rasters/mg2014.tif"))
library(gdalUtils)
library(gdata)
library(ggpubr)
library(ggthemes)
library(gridExtra)
library(raster)
library(rgdal)
library(sf)
library(sp)
library(spsurvey)
library(tidyverse)
raw_dir <- "./data/raw/"
proc_dir <- "./data/processed/"
scratch_dir <- "./data/scratch/"
dstrcts <- read_sf(paste0(proc_dir, "shapefiles/districts_mg/districts_mg.shp"))
soc <- raster(paste0(raw_dir, "rasters/Mangrove_soc_Thailand.tif"))
agb <- raster(paste0(raw_dir, "rasters/Mangrove_agb_Thailand.tif"))
dstrcts$ADM2_ID <- 1:nrow(dstrcts)
dstrcts <- dplyr::select(dstrcts, ADM1_EN, ADM2_EN, ADM2_ID, geometry)
dstrcts_sp <- as(dstrcts, "Spatial")
dstrct_avgs <- data.frame("ADM2_ID" = 1:nrow(dstrcts_sp),
"SOC_AVG" = NA, "SOC_SD" = NA,
"AGB_AVG" = NA, "AGB_SD" = NA)
soc_rmse <- 10.9    # Cross-validation RMSE value reported in Sanderman et al., 2018
#for(i in 1:nrow(dstrcts_sp)) {
for(i in 1:1) {
shp <- dstrcts_sp[i, ]
soc_crop <- crop(soc, shp)
soc_dat <- raster::extract(soc_crop, shp, df = T)
dstrct_avgs$SOC_AVG[i] <- mean(soc_dat$Mangrove_soc_Thailand, na.rm = T)
dstrct_avgs$SOC_SD[i] <- sd(soc_dat$Mangrove_soc_Thailand, na.rm = T)
#rm(soc_dat, soc_crop)
#gc()
}
hist(soc_dat)
skewness(soc_dat)
install.packages("e1071")
install.packages("e1071")
library(e1071)
library(gdalUtils)
library(gdata)
library(ggpubr)
library(ggthemes)
library(gridExtra)
library(raster)
library(rgdal)
library(sf)
library(sp)
library(spsurvey)
library(tidyverse)
raw_dir <- "./data/raw/"
proc_dir <- "./data/processed/"
scratch_dir <- "./data/scratch/"
dstrcts <- read_sf(paste0(proc_dir, "shapefiles/districts_mg/districts_mg.shp"))
soc <- raster(paste0(raw_dir, "rasters/Mangrove_soc_Thailand.tif"))
agb <- raster(paste0(raw_dir, "rasters/Mangrove_agb_Thailand.tif"))
dstrcts$ADM2_ID <- 1:nrow(dstrcts)
dstrcts <- dplyr::select(dstrcts, ADM1_EN, ADM2_EN, ADM2_ID, geometry)
dstrcts_sp <- as(dstrcts, "Spatial")
dstrct_avgs <- data.frame("ADM2_ID" = 1:nrow(dstrcts_sp),
"SOC_AVG" = NA, "SOC_SD" = NA,
"AGB_AVG" = NA, "AGB_SD" = NA)
soc_rmse <- 10.9    # Cross-validation RMSE value reported in Sanderman et al., 2018
#for(i in 1:nrow(dstrcts_sp)) {
for(i in 1:1) {
shp <- dstrcts_sp[i, ]
soc_crop <- crop(soc, shp)
soc_dat <- raster::extract(soc_crop, shp, df = T)
dstrct_avgs$SOC_AVG[i] <- mean(soc_dat$Mangrove_soc_Thailand, na.rm = T)
dstrct_avgs$SOC_SD[i] <- sd(soc_dat$Mangrove_soc_Thailand, na.rm = T)
#rm(soc_dat, soc_crop)
#gc()
}
skewness(soc_dat)
skewness(soc_dat, na.rm = T)
kurtosis(soc_dat, na.rm = T)
library(semTools)
install.packages("semTools")
library("semTools")
mvrnonnorm(length(soc_dat), mean(soc_dat))
?runif
hist(soc_dat)
#for(i in 1:nrow(dstrcts_sp)) {
for(i in 2:2) {
shp <- dstrcts_sp[i, ]
soc_crop <- crop(soc, shp)
soc_dat <- raster::extract(soc_crop, shp, df = T)
skew <- skewness(soc_dat, na.rm = T)
kurt <- e1071::kurtosis(soc_dat, na.rm = T)
dstrct_avgs$SOC_AVG[i] <- mean(soc_dat$Mangrove_soc_Thailand, na.rm = T)
dstrct_avgs$SOC_SD[i] <- sd(soc_dat$Mangrove_soc_Thailand, na.rm = T)
#rm(soc_dat, soc_crop)
#gc()
}
hist(soc_dat)
#for(i in 1:nrow(dstrcts_sp)) {
for(i in 3:3) {
shp <- dstrcts_sp[i, ]
soc_crop <- crop(soc, shp)
soc_dat <- raster::extract(soc_crop, shp, df = T)
skew <- skewness(soc_dat, na.rm = T)
kurt <- e1071::kurtosis(soc_dat, na.rm = T)
dstrct_avgs$SOC_AVG[i] <- mean(soc_dat$Mangrove_soc_Thailand, na.rm = T)
dstrct_avgs$SOC_SD[i] <- sd(soc_dat$Mangrove_soc_Thailand, na.rm = T)
#rm(soc_dat, soc_crop)
#gc()
}
hist(soc_dat)
#for(i in 1:nrow(dstrcts_sp)) {
for(i in 4:4) {
shp <- dstrcts_sp[i, ]
soc_crop <- crop(soc, shp)
soc_dat <- raster::extract(soc_crop, shp, df = T)
skew <- skewness(soc_dat, na.rm = T)
kurt <- e1071::kurtosis(soc_dat, na.rm = T)
dstrct_avgs$SOC_AVG[i] <- mean(soc_dat$Mangrove_soc_Thailand, na.rm = T)
dstrct_avgs$SOC_SD[i] <- sd(soc_dat$Mangrove_soc_Thailand, na.rm = T)
#rm(soc_dat, soc_crop)
#gc()
}
hist(soc_dat)
length(soc_dat)
soc_dat
nrow(soc_dat )
?sample
btstrp_dat <- sample(soc_dat, nrow(soc_dat), replace = T)
btstrp_dat
mean(soc_dat)
mean(soc_dat, na.rm = T)
mean(soc_dat$Mangrove_soc_Thailand, na.rm = T)
colnames(btstrp_dat)
str(btstrp_dat)
btstrp_dat <- sample(soc_dat$Mangrove_soc_Thailand, nrow(soc_dat), replace = T)
head(btstrp_dat)
mean(soc_dat$Mangrove_soc_Thailand, na.rm = T)
mean(btstrp_dat, na.rm = T)
btstrp_dat
btstrp_dat <- c()
for(i in 1:10) {
run <- sample(soc_dat$Mangrove_soc_Thailand, nrow(soc_dat), replace = T)
btstrp_dat <- c(btstrp_dat, mean(run, na.rm = T))
}
btstrp_dat
#for(i in 1:nrow(dstrcts_sp)) {
for(i in 1:1) {
shp <- dstrcts_sp[i, ]
soc_crop <- crop(soc, shp)
soc_dat <- raster::extract(soc_crop, shp, df = T)
btstrp_dat <- c()
for(i in 1:10) {
run <- sample(soc_dat$Mangrove_soc_Thailand, nrow(soc_dat), replace = T)
btstrp_dat <- c(btstrp_dat, mean(run, na.rm = T))
}
dstrct_avgs$SOC_AVG[i] <- mean(soc_dat$Mangrove_soc_Thailand, na.rm = T)
dstrct_avgs$SOC_SD[i] <- sd(soc_dat$Mangrove_soc_Thailand, na.rm = T)
#rm(soc_dat, soc_crop)
#gc()
}
btstrp_dat
?run2
?rnorm
sd(soc_dat)
sd(soc_dat, na.rm = T)
sd(soc_dat$Mangrove_soc_Thailand, na.rm = T)
prpgt_sd <- sqrt( sd(soc_dat$Mangrove_soc_Thailand)^2  + soc_rmse^2  )
prpgt_sd
prpgt_sd <- sqrt( sd(soc_dat$Mangrove_soc_Thailand, na.rm = T)^2  + soc_rmse^2  )
prpgt_sd
prpgt_sd <- sqrt( sd(soc_dat$Mangrove_soc_Thailand)^2  + soc_rmse^2  )
run2 <- rnorm(nrow(!is.na(soc_dat$Mangrove_soc_Thailand)), mean = mean(soc_dat$Mangrove_soc_Thailand, na.rm = T), sd = prpgt_sd)
soc_vals <- drop_na(soc_dat$Mangrove_soc_Thailand)
soc_dat$Mangrove_soc_Thailand
soc_vals <- soc_dat$Mangrove_soc_Thailand[is.na(soc_dat$Mangrove_soc_Thailand)]
soc_vals
soc_dat$Mangrove_soc_Thailand
soc_vals <- soc_dat$Mangrove_soc_Thailand[!is.na(soc_dat$Mangrove_soc_Thailand)]
soc_vals
run <- sample(soc_vals, length(soc_vals), replace = T)
mean(run)
mean(soc_vals)
run <- sample(soc_vals, length(soc_vals), replace = T)
mean(run)
run <- sample(soc_vals, 100, replace = T)
mean(run)
run <- sample(soc_vals, 100, replace = T)
mean(run)
run <- sample(soc_vals, 100, replace = T)
mean(run)
btstrp_dat <- c()
for(i in 1:100) {
soc_vals <- soc_dat$Mangrove_soc_Thailand[!is.na(soc_dat$Mangrove_soc_Thailand)]
run <- sample(soc_vals, 100, replace = T)
#prpgt_sd <- sqrt( sd(soc_dat$Mangrove_soc_Thailand)^2  + soc_rmse^2  )
#run2 <- rnorm(nrow(!is.na(soc_dat$Mangrove_soc_Thailand)), mean = mean(soc_dat$Mangrove_soc_Thailand, na.rm = T), sd = prpgt_sd)
btstrp_dat <- c(btstrp_dat, mean(run, na.rm = T))
}
btstrp_dat
hist(btstrp_dat)
btstrp_dat <- c()
for(i in 1:10000) {
soc_vals <- soc_dat$Mangrove_soc_Thailand[!is.na(soc_dat$Mangrove_soc_Thailand)]
run <- sample(soc_vals, 100, replace = T)
#prpgt_sd <- sqrt( sd(soc_dat$Mangrove_soc_Thailand)^2  + soc_rmse^2  )
#run2 <- rnorm(nrow(!is.na(soc_dat$Mangrove_soc_Thailand)), mean = mean(soc_dat$Mangrove_soc_Thailand, na.rm = T), sd = prpgt_sd)
btstrp_dat <- c(btstrp_dat, mean(run, na.rm = T))
}
for(i in 1:1000) {
soc_vals <- soc_dat$Mangrove_soc_Thailand[!is.na(soc_dat$Mangrove_soc_Thailand)]
run <- sample(soc_vals, 100, replace = T)
#prpgt_sd <- sqrt( sd(soc_dat$Mangrove_soc_Thailand)^2  + soc_rmse^2  )
#run2 <- rnorm(nrow(!is.na(soc_dat$Mangrove_soc_Thailand)), mean = mean(soc_dat$Mangrove_soc_Thailand, na.rm = T), sd = prpgt_sd)
btstrp_dat <- c(btstrp_dat, mean(run, na.rm = T))
}
btstrp_dat
mean(btstrp_dat)
mean(soc_vals)
hist(btstrp_dat)
hist(soc_vals)
hist(btstrp_dat)
hist(soc_vals)
hist(btstrp_dat)
library(plotrix)
std.error(btstrp_dat)
std.error(soc_vals)
dstrct_avgs
std.error(bbtstrp_dat, na.rm = T)
std.error(btstrp_dat, na.rm = T)
btstrp_dat <- c()
for(i in 1:1000) {
soc_vals <- soc_dat$Mangrove_soc_Thailand[!is.na(soc_dat$Mangrove_soc_Thailand)]
run <- sample(soc_vals, 1000, replace = T)
#prpgt_sd <- sqrt( sd(soc_dat$Mangrove_soc_Thailand)^2  + soc_rmse^2  )
#run2 <- rnorm(nrow(!is.na(soc_dat$Mangrove_soc_Thailand)), mean = mean(soc_dat$Mangrove_soc_Thailand, na.rm = T), sd = prpgt_sd)
btstrp_dat <- c(btstrp_dat, mean(run, na.rm = T))
}
std.error(btstrp_dat, na.rm = T)
mean(btstrp_dat, na.rm = T)
mg2000_df <- mg2000 %>%
st_set_geometry(NULL) %>%
select(ADM2_EN, mangrov)
library(e1071)
library(gdalUtils)
library(gdata)
library(ggpubr)
library(ggthemes)
library(gridExtra)
library(raster)
library(rgdal)
library(sf)
library(sp)
library(spsurvey)
library(tidyverse)
raw_dir <- "./data/raw/"
proc_dir <- "./data/processed/"
scratch_dir <- "./data/scratch/"
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
mg2000 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2000")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014_ls <- st_read(paste0(proc_dir, "shapefiles/dstrct_losses_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
mutate(mines = NA)
mg2014_gn <- st_read(paste0(proc_dir, "shapefiles/dstrct_gains_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
calcCarbon <- function(sf_obj, agb_rate, soc_rate) {
df <- sf_obj %>%
mutate(aqua_c = (aqucltr * AGB_AVG * agb_rate) + (aqucltr * SOC_AVG * soc_rate),
aqua_c_sd = (aqucltr * AGB_SD * agb_rate) + (aqucltr * SOC_SD * soc_rate),
agri_c = (agrcltr * AGB_AVG * agb_rate) + (agrcltr * SOC_AVG * soc_rate),
agri_c_sd = (agrcltr * AGB_SD * agb_rate) + (agrcltr * SOC_SD * soc_rate),
mine_c = (mines * AGB_AVG * agb_rate) + (mines * SOC_AVG * soc_rate),
mine_c_sd = (mines * AGB_SD * agb_rate) + (mines * SOC_SD * soc_rate),
abnd_c = (abandnd * AGB_AVG * agb_rate) + (abandnd * SOC_AVG * soc_rate),
abnd_c_sd = (abandnd * AGB_SD * agb_rate) + (abandnd * SOC_SD * soc_rate),
salt_c = (slt_frm * AGB_AVG * agb_rate) + (slt_frm * SOC_AVG * soc_rate),
salt_c_sd = (slt_frm * AGB_SD * agb_rate) + (slt_frm * SOC_SD * soc_rate),
urbn_c = (urban * AGB_AVG * agb_rate) + (urban * SOC_AVG * soc_rate),
urbn_c_sd = (urban * AGB_SD * agb_rate) + (urban * SOC_SD * soc_rate)) %>%
st_set_geometry(NULL) %>%
dplyr::select(aqua_c, aqua_c_sd, agri_c, agri_c_sd,
mine_c, mine_c_sd, abnd_c, abnd_c_sd,
salt_c, salt_c_sd, urbn_c, urbn_c_sd)
ttls <- colSums(df, na.rm = T)
ttl <- sum(ttls)
return(ttls)
}
mg2000_hls <- calcCarbon(mg2000, agb_rate = 1, soc_rate = 0.67)
mg2000_mls <- calcCarbon(mg2000, agb_rate = 0.82, soc_rate = 0.54)
mg2000_lls <- calcCarbon(mg2000, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hls <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67)
mg2014_mls <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54)
mg2014_lls <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hgn <- calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.19)
mg2014_mgn <- calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.1)
mg2014_lgn <- calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
mg2014_hls_hgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.19)
mg2014_hls_mgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.1)
mg2014_hls_lgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
mg2014_mls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.19)
mg2014_mls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.1)
mg2014_mls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
mg2014_lls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.19)
mg2014_lls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.1)
mg2014_lls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
carbonTable <- rbind(mg2000_hls, mg2000_mls, mg2000_lls,
mg2014_hls, mg2014_mls, mg2014_lls,
mg2014_hgn, mg2014_mgn, mg2014_lgn,
mg2014_hls_hgn, mg2014_hls_mgn, mg2014_hls_lgn,
mg2014_mls_hgn, mg2014_mls_mgn, mg2014_mls_lgn,
mg2014_lls_hgn, mg2014_lls_mgn, mg2014_lls_lgn) %>%
as.data.frame() %>%
mutate(year = c(rep("2000", 3), rep("2014", 15)),
loss = c("hgh", "med", "low", rep(NA, 3), "high", "med", "low", rep("hgh", 3), rep("med", 3), rep("low", 3)),
gain = c(rep(NA, 3), "high", "med", "low", rep(NA, 3), rep(c("hgh", "med", "low"), 3)))
carbonTable %>%
mutate(ttl = (aqua_c + agri_c + mine_c + abnd_c + salt_c + urbn_c) / 1000000,
ttl_sd = (aqua_c_sd + agri_c_sd + mine_c_sd + abnd_c_sd + salt_c_sd + urbn_c_sd) / 1000000)
mg2000_df <- mg2000 %>%
st_set_geometry(NULL) %>%
select(ADM2_EN, mangrov)
mg2014_df <- mg2014 %>%
st_set_geometry(NULL) %>%
select(ADM2_EN, mangrov)
net <- mg2014_df %>%
left_join(mg2000_df, by = "ADM2_EN", suffix = c("_14", "_00")) %>%
replace(is.na(.), 0) %>%
mutate(mangrov_net = mangrov_14 - mangrov_00) %>%
select(ADM2_EN, mangrov_net) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN")) %>%
mutate(net_mg_c_ls = (mangrov_net * AGB_AVG * 0.82) + (mangrov_net * SOC_AVG * 0.54)) %>%
select(ADM2_EN, net_mg_c_ls)
sum(net$net_mg_c_ls)
mg2014_gn_df <- mg2014_gn %>%
st_set_geometry(NULL) %>%
select(aqucltr, agrcltr, mangrov, abandnd, slt_frm, urban) %>%
summarize_all(~sum(., na.rm = T))
mg2014_ls_df <- mg2014_ls %>%
st_set_geometry(NULL) %>%
select(aqucltr, agrcltr, mangrov, abandnd, slt_frm, urban) %>%
summarize_all(~sum(., na.rm = T))
mg2014_gn_df <- mg2014_gn %>%
st_set_geometry(NULL) %>%
select(aqucltr, agrcltr, mangrov, abandnd, slt_frm, urban) %>%
summarize_all(~sum(., na.rm = T))
mg2014_ls_df
mg2014_gn_df
net <- mg2014_df %>%
left_join(mg2000_df, by = "ADM2_EN", suffix = c("_14", "_00")) %>%
replace(is.na(.), 0) %>%
mutate(mangrov_net = mangrov_14 - mangrov_00) %>%
select(ADM2_EN, mangrov_net) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN")) %>%
mutate(net_mg_c_ls = (mangrov_net * AGB_AVG * 0.82) + (mangrov_net * SOC_AVG * 0.54),
net_mg_c_ls = (mangrov_net * AGB_SD * 0.82) + (mangrov_net * SOC_SD * 0.54)) %>%
select(ADM2_EN, net_mg_c_ls)
net
sum(net$net_mg_c_ls)
net <- mg2014_df %>%
left_join(mg2000_df, by = "ADM2_EN", suffix = c("_14", "_00")) %>%
replace(is.na(.), 0) %>%
mutate(mangrov_net = mangrov_14 - mangrov_00) %>%
select(ADM2_EN, mangrov_net) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN")) %>%
mutate(net_mg_c_ls = (mangrov_net * AGB_AVG * 0.82) + (mangrov_net * SOC_AVG * 0.54),
net_mg_c_ls_sd = (mangrov_net * AGB_SD * 0.82) + (mangrov_net * SOC_SD * 0.54)) %>%
select(ADM2_EN, net_mg_c_ls)
sum(net$net_mg_c_ls)
sum(net$net_mg_c_ls_sd)
net <- mg2014_df %>%
left_join(mg2000_df, by = "ADM2_EN", suffix = c("_14", "_00")) %>%
replace(is.na(.), 0) %>%
mutate(mangrov_net = mangrov_14 - mangrov_00) %>%
select(ADM2_EN, mangrov_net) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN")) %>%
mutate(net_mg_c_ls = (mangrov_net * AGB_AVG * 0.82) + (mangrov_net * SOC_AVG * 0.54),
net_mg_c_ls_sd = (mangrov_net * AGB_SD * 0.82) + (mangrov_net * SOC_SD * 0.54)) %>%
select(ADM2_EN, net_mg_c_ls)
net <- mg2014_df %>%
left_join(mg2000_df, by = "ADM2_EN", suffix = c("_14", "_00")) %>%
replace(is.na(.), 0) %>%
mutate(mangrov_net = mangrov_14 - mangrov_00) %>%
select(ADM2_EN, mangrov_net) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN")) %>%
mutate(net_mg_c_ls = (mangrov_net * AGB_AVG * 0.82) + (mangrov_net * SOC_AVG * 0.54),
net_mg_c_ls_sd = (mangrov_net * AGB_SD * 0.82) + (mangrov_net * SOC_SD * 0.54)) %>%
select(ADM2_EN, net_mg_c_ls, net_mg_c_ls_sd)
sum(net$net_mg_c_ls)
sum(net$net_mg_c_ls_sd)
library(ggmap)
library(ggpubr)
library(grid)
library(gridExtra)
library(ggthemes)
library(raster)
library(rasterVis)
library(sf)
library(tidyverse)
proc_dir <- "./data/processed/"
scratch_dir <- "./data/scratch/"
raw_dir <- "./data/raw/"
dat <- read_xlsx("./data/raw/sigit_data.xlsx") %>%
dplyr::select(dataset_variable, yr = "regeneration age", agb = mean) %>%
filter(dataset_variable == "Aboveground biomass carbon stock") %>%
as.data.frame()
prop_df <- read_csv("./data/processed/eq1_mdlRuns.csv")
ggplot(dat, aes(yr, agb)) +
geom_point(color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("Aboveground Biomass Carbon (Mg / ha)") +
xlab("Years") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte()
dat <- read_xlsx("./data/raw/sigit_data.xlsx") %>%
dplyr::select(dataset_variable, yr = "regeneration age", agb = mean) %>%
filter(dataset_variable == "Aboveground biomass carbon stock") %>%
as.data.frame()
library(readxl)
dat <- read_xlsx("./data/raw/sigit_data.xlsx") %>%
dplyr::select(dataset_variable, yr = "regeneration age", agb = mean) %>%
filter(dataset_variable == "Aboveground biomass carbon stock") %>%
as.data.frame()
prop_df <- read_csv("./data/processed/eq1_mdlRuns.csv")
ggplot(dat, aes(yr, agb)) +
geom_point(color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("Aboveground Biomass Carbon (Mg / ha)") +
xlab("Years") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte()
ggsave("./figs/fig4_growth.jpg", growthMdl, width = 11, height = 5, units = c("in"), device = "jpeg")
growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("Aboveground Biomass Carbon (Mg / ha)") +
xlab("Years") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte()
ggsave("./figs/fig4_growth.jpg", growthMdl, width = 11, height = 5, units = c("in"), device = "jpeg")
ggsave("./figs/fig4_growth.jpg", growthMdl, width = 8, height = 5, units = c("in"), device = "jpeg")
