net
net <- mg2014_df %>%
left_join(mg2000_df, by = "ADM2_EN", suffix = c("_14", "_00")) %>%
replace(is.na(.), 0) %>%
mutate(mangrov_net = mangrov_14 - mangrov_00) %>%
dplyr::select(ADM2_EN, mangrov_net) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN")) %>%
mutate(net_mg_c_ls_hgh = (mangrov_net * AGB_AVG * 1) + (mangrov_net * SOC_AVG * 0.67),
net_mg_c_ls_se_hgh = (mangrov_net * AGB_SE * 1) + (mangrov_net * SOC_SE * 0.67),
net_mg_c_ls_med = (mangrov_net * AGB_AVG * 0.82) + (mangrov_net * SOC_AVG * 0.54),
net_mg_c_ls_se_med = (mangrov_net * AGB_SE * 0.82) + (mangrov_net * SOC_SE * 0.54),
net_mg_c_ls_low = (mangrov_net * AGB_AVG * 0.47) + (mangrov_net * SOC_AVG * 0.41),
net_mg_c_ls_se_low = (mangrov_net * AGB_SE * 0.47) + (mangrov_net * SOC_SE * 0.41)) %>%
dplyr::select(ADM2_EN, net_mg_c_ls_hgh:net_mg_c_ls_se_low)
net_total <- sum(net$net_mg_c_ls / 1000000, na.rm = T)
net_total_se <- sum(net$net_mg_c_ls_se / 1000000, na.rm = T)
net_total
net
net %>%
select(-ADM2_EN) %>%
colSums(select(net, - ADM2_EN))
colSums(select(net, - ADM2_EN), na.rm = T)
colSums(select(net, - ADM2_EN), na.rm = T) / 1000000
net_ttls <- colSums(select(net, - ADM2_EN), na.rm = T) / 1000000
net_total <- net_ttls$net_mg_c_ls_med
net_ttls
net_ttls <- rbind(colSums(select(net, - ADM2_EN), na.rm = T) / 1000000)
net_ttls
net_total <- net_ttls$net_mg_c_ls_med
net_ttls <- as.data.frame(rbind(colSums(select(net, - ADM2_EN), na.rm = T) / 1000000))
net_ttls
net_total <- net_ttls$net_mg_c_ls_med
net_total <- net_ttls$net_mg_c_ls_med
net_total_se <- net_ttls$net_mg_c_ls_se_med
net_total
net_total_se
smryDat2000 <- smryDat2000 %>%
mutate(net_ttl = net_total * -1, net_ttl_se = net_total_se * -1)
smryDat2014 <- smryDat2014 %>%
mutate(net_ttl = net_total * -1, net_ttl_se = net_total_se * -1)
sryDat2014
smryDat2014
smryDat2000 <- smryDat2000 %>%
mutate(net_ttl = ifelse(loss == "hgh", net_ttls$net_mg_c_ls_hgh * -1,
ifelse(loss == "med", net_ttls$net_mg_c_ls_med * -1, net_ttls$net_mg_c_ls_low * -1)),
net_ttl_se = ifelse(loss == "hgh", net_ttls$net_mg_c_ls_se_hgh * -1,
ifelse(loss == "med", net_ttls$net_mg_c_ls_se_med * -1, net_ttls$net_mg_c_ls_se_low * -1)))
smryDat2000
smryDat2014 <- smryDat2014 %>%
mutate(net_ttl = ifelse(loss == "hgh", net_ttls$net_mg_c_ls_hgh * -1,
ifelse(loss == "med", net_ttls$net_mg_c_ls_med * -1, net_ttls$net_mg_c_ls_low * -1)),
net_ttl_se = ifelse(loss == "hgh", net_ttls$net_mg_c_ls_se_hgh * -1,
ifelse(loss == "med", net_ttls$net_mg_c_ls_se_med * -1, net_ttls$net_mg_c_ls_se_low * -1)))
smryDat2014
7.02 - 3.93
allPrdsSmry <- data.frame(year = c("pre-1960 - 2000", "2000-2014, LULCC", "2000-2014, LULCC", "2000-2014, net"),
carbon = c(-34.56, -7.02, 3.93, -1.8),
error = c(-0.30, -0.06, 0.03, -0.02),
net = c(NA, -3.09, -3.09, -1.8),
style = c("Loss", "Loss", "Gain", "Net"))
write_csv(allPrdsSmry, "./data/processed/allPrdsSmry.csv")
write_csv(smryDat2014, "./data/processed/carbonSummary2014.csv")
dat2014 <- read_csv("./data/processed/carbonSummary2014.csv")
dat2plt <- dat2014 %>%
mutate(loss = factor(loss, levels = c("low", "med", "hgh")),
gain = factor(gain, levels = c("hgh", "med", "low"))) %>%
group_by(loss) %>%
mutate(avg_ttl = mean(ttl)) %>%
ungroup() %>%
mutate(loss_clr = ifelse(loss == "low", "#44aa99", ifelse(loss == "med", "#117733", "#88ccee"))) %>%
arrange(loss, ttl)
levels(dat2plt$loss) = list(`Low Rate of C Stock Loss`="low", `Medium Rate of C Stock Loss`="med", `High Rate of C Stock Loss`="hgh")
levels(dat2plt$gain) = list(High="hgh", Medium="med", Low="low")
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss), fill = NA, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
ylim(c(0,8)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss), fill = NA, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
#ylim(c(0,8)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss), fill = NA, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
#ylim(c(0,8)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
#geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
dat2000 <- read_csv("./data/processed/allPrdsSmry.csv") %>%
mutate(error = error * 1.96)
dat2000$year[1] <- "1960 - 2000"
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .2, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
#guides(linetype = "none", alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .1, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
#guides(linetype = "none", alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
ggsave("./figs/fig3_stocks.jpg", fig3, width = 4, height = 6, units = c("in"), device = "jpeg")
dat2014 <- read_csv("./data/processed/carbonSummary2014.csv")
dat2plt <- dat2014 %>%
mutate(loss = factor(loss, levels = c("low", "med", "hgh")),
gain = factor(gain, levels = c("hgh", "med", "low"))) %>%
group_by(loss) %>%
mutate(avg_ttl = mean(ttl)) %>%
ungroup() %>%
mutate(loss_clr = ifelse(loss == "low", "#44aa99", ifelse(loss == "med", "#117733", "#88ccee"))) %>%
arrange(loss, ttl)
levels(dat2plt$loss) = list(`Low Rate of C Stock Loss`="low", `Medium Rate of C Stock Loss`="med", `High Rate of C Stock Loss`="hgh")
levels(dat2plt$gain) = list(High="hgh", Medium="med", Low="low")
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss), fill = NA, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
#ylim(c(0,8)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss), fill = NA, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
#ylim(c(0,8)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
#geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), fill = NA, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
#ylim(c(0,8)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
#geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
#ylim(c(0,8)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
#geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), alpha = 0.2, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
#ylim(c(0,8)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
#geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), alpha = 0.2, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
ylim(c(-2.5, 7.5)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
#geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), alpha = 0.2, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
ylim(c(-2.5, 7.5)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
#geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), alpha = 0.2, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
ylim(c(-2.5, 7.5)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
geom_hline(aes(yintercept = 0), col = "black", linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), alpha = 0.2, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
ylim(c(-2.5, 7.5)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
geom_hline(aes(yintercept = 0), col = "grey", linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), alpha = 0.2, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
ylim(c(-2.5, 7.5)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
#geom_hline(aes(yintercept = 0), col = "grey", linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), alpha = 0.2, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
ylim(c(-2.5, 7.5)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
#geom_hline(aes(yintercept = 0), col = "grey", linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, col = loss, fill = loss), alpha = 0.2, width = 0.7, stat = "identity") +
#geom_point(aes(x = gain, y = ttl, col = loss), fill = NA, size = 1.5, shape = 19, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_se * 1.96, ymax = ttl + ttl_se * 1.96, col = loss), alpha = 0.8, width = .1, position = position_dodge(.9)) +
ylim(c(-2.5, 7.5)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
#geom_hline(aes(yintercept = 0), col = "grey", linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig4
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .1, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
#guides(linetype = "none", alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
fig4
ggsave("./figs/fig4_assumptions.jpg", fig4, width = 6, height = 5, units = c("in"), device = "jpeg")
