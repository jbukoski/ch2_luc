ggsave("./figs/fig4_assumptions.jpg", fig4, width = 8, height = 6, units = c("in"), device = "jpeg")
ggsave("./figs/fig4_assumptions.jpg", fig4, width = 6, height = 4, units = c("in"), device = "jpeg")
dat <- read_xlsx("./data/raw/sigit_data.xlsx") %>%
dplyr::select(dataset_variable, yr = "regeneration age", agb = mean) %>%
filter(dataset_variable == "Aboveground biomass carbon stock") %>%
as.data.frame()
prop_df <- read_csv("./data/processed/eq1_mdlRuns.csv")
fig3_growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 18, y = 225, label = "t = 14", col = "red") +
geom_vline(xintercept = 14, linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
fig3_growthMdl
fig3_growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 18, y = 225, label = "t = 14", col = "red") +
geom_vline(xintercept = 14, linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.text.x = element_text(family = "sans"))
fig3_growthMdl
fig3_growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 18, y = 225, label = "t = 14", col = "red") +
geom_vline(xintercept = 14, linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.title.x = element_text(family = "sans"))
fig3_growthMdl
fig3_growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 18, y = 225, label = "t = 14", col = "red") +
geom_vline(xintercept = 14, linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.title.x = element_text(family = "sans"),
axis.title.y = element_text(family = "sans"))
fig3_growthMdl
ggsave("./figs/fig2_growth.jpg", fig3_growthMdl, width = 6, height = 4, units = c("in"), device = "jpeg")
gadm_sea <- st_read(paste0(raw_dir, "shapefiles/gadm_se_asia.shp"))
tha <- st_read(paste0(raw_dir, "shapefiles/gadm_se_asia.shp")) %>%
filter(NAME_0 == "Thailand")
mg2014 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
mutate(aqucltr = ifelse(is.na(aqucltr), 0, aqucltr),
agrcltr = ifelse(is.na(agrcltr), 0, agrcltr),
mangrov = ifelse(is.na(mangrov), 0, mangrov),
mg_loss = 100 * (total - mangrov) / total,
loss2aqua = 100 * (aqucltr / (total - mangrov)),
loss2agri = 100 * (agrcltr / (total - mangrov)))
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "light blue"),
axis.title.x = element_blank(),
axis.title.y = element_blank())
p1 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = (total - mangrov) / 1000), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#228B22") +
guides(fill = guide_legend(title = "Mangrove Area (10e3 ha)")) +
annotate(geom = "text", label = "a",  x = 103.25, y = 13.5, size = 8, color = "black")
p2 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = mg_loss), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#FF0000") +
guides(fill = guide_legend(title = "Mangrove Loss (%)")) +
annotate(geom = "text", label = "b",  x = 103.25, y = 13.5, size = 8, color = "black")
p3 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2aqua), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#0000FF", breaks=c(0,20,40,60,80,100)) +
guides(fill = guide_legend(title = "Loss to Aquaculture (%)")) +
annotate(geom = "text", label = "c",  x = 103.25, y = 13.5, size = 8, color = "black")
p4 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2agri), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#FFAA1D") +
guides(fill = guide_legend(title = "Loss to Agriculture (%)")) +
annotate(geom = "text", label = "d",  x = 103.25, y = 13.5, size = 8, color = "black")
f1 <- grid.arrange(p1, p2, p3, p4, nrow = 2)
f1
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "light blue", alpha = 0.5),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "light blue"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "#88CCEE"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "#44AA99"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "#88CCEE"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
p1 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = (total - mangrov) / 1000), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#117733") +
guides(fill = guide_legend(title = "Mangrove Area (kha)")) +
annotate(geom = "text", label = "a",  x = 103.25, y = 13.5, size = 8, color = "black")
p2 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = mg_loss), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#CC6677") +
guides(fill = guide_legend(title = "Mangrove Loss (%)")) +
annotate(geom = "text", label = "b",  x = 103.25, y = 13.5, size = 8, color = "black")
p3 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2aqua), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#AA4499", breaks=c(0,20,40,60,80,100)) +
guides(fill = guide_legend(title = "Loss to Aquaculture (%)")) +
annotate(geom = "text", label = "c",  x = 103.25, y = 13.5, size = 8, color = "black")
p4 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2agri), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#882255") +
guides(fill = guide_legend(title = "Loss to Agriculture (%)")) +
annotate(geom = "text", label = "d",  x = 103.25, y = 13.5, size = 8, color = "black")
f1 <- grid.arrange(p1, p2, p3, p4, nrow = 2)
f1
p3 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2aqua), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#332288", breaks=c(0,20,40,60,80,100)) +
guides(fill = guide_legend(title = "Loss to Aquaculture (%)")) +
annotate(geom = "text", label = "c",  x = 103.25, y = 13.5, size = 8, color = "black")
p4 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2agri), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#882255") +
guides(fill = guide_legend(title = "Loss to Agriculture (%)")) +
annotate(geom = "text", label = "d",  x = 103.25, y = 13.5, size = 8, color = "black")
f1 <- grid.arrange(p1, p2, p3, p4, nrow = 2)
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "#87CBEE"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "#87CBEE", fill = "transparent"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(colour = "#87CBEE", fill = "transparent"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(colour = "#87CBEE"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "#87CBEE"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "#56B4E9"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
base
base <- ggplot(data = gadm_sea) +
geom_sf(fill = "#F5F5F5", size  = 0.1) +
geom_sf(data = tha, fill = "#E8E8E8", size = 0.2) +
xlim(c(97.5, 103.5)) +
ylim(c(5.75, 13.75)) +
theme_bw() +
theme(legend.position = "bottom",
panel.background = element_rect(fill = "#C0E3F7"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank())
p1 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = (total - mangrov) / 1000), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#009E73") +
guides(fill = guide_legend(title = "Mangrove Area (kha)")) +
annotate(geom = "text", label = "a",  x = 103.25, y = 13.5, size = 8, color = "black")
p2 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = mg_loss), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#CC79A7") +
guides(fill = guide_legend(title = "Mangrove Loss (%)")) +
annotate(geom = "text", label = "b",  x = 103.25, y = 13.5, size = 8, color = "black")
p3 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2aqua), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#0072B2", breaks=c(0,20,40,60,80,100)) +
guides(fill = guide_legend(title = "Loss to Aquaculture (%)")) +
annotate(geom = "text", label = "c",  x = 103.25, y = 13.5, size = 8, color = "black")
p4 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2agri), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#D55E00") +
guides(fill = guide_legend(title = "Loss to Agriculture (%)")) +
annotate(geom = "text", label = "d",  x = 103.25, y = 13.5, size = 8, color = "black")
f1 <- grid.arrange(p1, p2, p3, p4, nrow = 2)
ggsave("./figs/f1_loss_map.jpg", f1, width = 10.2, height = 13.2, units = c("in"), device = "jpeg")
p1
mg2014
3657 + 157 + 405 + 35.63 + 8.218 + 940.576 + 109.8
p1 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = (total) / 1000), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#009E73") +
guides(fill = guide_legend(title = "Mangrove Area (kha)")) +
annotate(geom = "text", label = "a",  x = 103.25, y = 13.5, size = 8, color = "black")
p1
p2 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = mg_loss), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#CC79A7") +
guides(fill = guide_legend(title = "Mangrove Loss (%)")) +
annotate(geom = "text", label = "b",  x = 103.25, y = 13.5, size = 8, color = "black")
p3 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2aqua), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#0072B2", breaks=c(0,20,40,60,80,100)) +
guides(fill = guide_legend(title = "Loss to Aquaculture (%)")) +
annotate(geom = "text", label = "c",  x = 103.25, y = 13.5, size = 8, color = "black")
p4 <- base +
geom_sf(data = mg2014, aes(geometry = geometry, fill = loss2agri), size = 0.2) +
scale_fill_gradient(low = "#ffffff", high = "#D55E00") +
guides(fill = guide_legend(title = "Loss to Agriculture (%)")) +
annotate(geom = "text", label = "d",  x = 103.25, y = 13.5, size = 8, color = "black")
f1 <- grid.arrange(p1, p2, p3, p4, nrow = 2)
ggsave("./figs/f1_loss_map.jpg", f1, width = 10.2, height = 13.2, units = c("in"), device = "jpeg")
mg2014
mg2014$loss2aqua + mg2014$loss2agri
mg2014_hgn <- calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 1)
mg2014_mgn <- calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.5)
print("Begin Step 3. backmodeling of carbon stocks to historical mangrove extent...")
library(e1071)
library(gdalUtils)
library(gdata)
library(ggpubr)
library(ggthemes)
library(gridExtra)
library(raster)
library(rgdal)
library(sf)
library(sp)
library(spsurvey)
library(tidyverse)
raw_dir <- "./data/raw/"
proc_dir <- "./data/processed/"
scratch_dir <- "./data/scratch/"
dstrcts <- read_sf(paste0(proc_dir, "shapefiles/districts_mg/districts_mg.shp"))
soc <- raster(paste0(raw_dir, "rasters/Mangrove_soc_Thailand.tif"))
agb <- raster(paste0(raw_dir, "rasters/Mangrove_agb_Thailand.tif"))
dstrcts$ADM2_ID <- 1:nrow(dstrcts)
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
mg2000 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2000")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014_ls <- st_read(paste0(proc_dir, "shapefiles/dstrct_losses_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
mutate(mines = NA)
mg2014_gn <- st_read(paste0(proc_dir, "shapefiles/dstrct_gains_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
calcCarbon <- function(sf_obj, agb_rate, soc_rate) {
df <- sf_obj %>%
mutate(aqua_c = (aqucltr * AGB_AVG * agb_rate) + (aqucltr * SOC_AVG * soc_rate),
aqua_c_sd = (aqucltr * AGB_SD * agb_rate) + (aqucltr * SOC_SD * soc_rate),
agri_c = (agrcltr * AGB_AVG * agb_rate) + (agrcltr * SOC_AVG * soc_rate),
agri_c_sd = (agrcltr * AGB_SD * agb_rate) + (agrcltr * SOC_SD * soc_rate),
abnd_c = (abandnd * AGB_AVG * agb_rate) + (abandnd * SOC_AVG * soc_rate),
abnd_c_sd = (abandnd * AGB_SD * agb_rate) + (abandnd * SOC_SD * soc_rate),
salt_c = (slt_frm * AGB_AVG * agb_rate) + (slt_frm * SOC_AVG * soc_rate),
salt_c_sd = (slt_frm * AGB_SD * agb_rate) + (slt_frm * SOC_SD * soc_rate),
urbn_c = (urban * AGB_AVG * agb_rate) + (urban * SOC_AVG * soc_rate),
urbn_c_sd = (urban * AGB_SD * agb_rate) + (urban * SOC_SD * soc_rate)) %>%
st_set_geometry(NULL) %>%
dplyr::select(aqua_c, aqua_c_sd, agri_c, agri_c_sd, abnd_c, abnd_c_sd,
salt_c, salt_c_sd, urbn_c, urbn_c_sd)
ttls <- colSums(df, na.rm = T)
ttl <- sum(ttls)
return(ttls)
}
mg2000_hls <- calcCarbon(mg2000, agb_rate = 1, soc_rate = 0.67)
mg2000_mls <- calcCarbon(mg2000, agb_rate = 0.82, soc_rate = 0.54)
mg2000_lls <- calcCarbon(mg2000, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hls <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67)
mg2014_mls <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54)
mg2014_lls <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hgn <- calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.19)
mg2014_mgn <- calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.1)
mg2014_lgn <- calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
mg2014_hgn <- calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 1)
mg2014_mgn <- calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.5)
mg2014_lgn <- calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
mg2014_hls_hgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.19)
mg2014_hls_mgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.1)
mg2014_hls_lgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
mg2014_mls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.19)
mg2014_mls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.1)
mg2014_mls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
mg2014_lls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.19)
mg2014_lls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.1)
mg2014_lls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
carbonTable <- rbind(mg2000_hls, mg2000_mls, mg2000_lls,
mg2014_hls, mg2014_mls, mg2014_lls,
mg2014_hgn, mg2014_mgn, mg2014_lgn,
mg2014_hls_hgn, mg2014_hls_mgn, mg2014_hls_lgn,
mg2014_mls_hgn, mg2014_mls_mgn, mg2014_mls_lgn,
mg2014_lls_hgn, mg2014_lls_mgn, mg2014_lls_lgn) %>%
as.data.frame() %>%
mutate(year = c(rep("2000", 3), rep("2014", 15)),
loss = c(rep(c("hgh", "med", "low"), 3), rep("hgh", 3), rep("med", 3), rep("low", 3)),
gain = c(rep(NA, 3), rep(NA, 3), rep(c("hgh", "med", "low"), 4))) %>%
mutate(ttl = (aqua_c + agri_c + abnd_c + salt_c + urbn_c) / 1000000,
ttl_sd = (aqua_c_sd + agri_c_sd + abnd_c_sd + salt_c_sd + urbn_c_sd) / 1000000)
carbonTable
mg2014_mls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 1)
mg2014_mls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.5)
mg2014_mls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
mg2014_lls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.65, soc_rate = 0.19)
mg2014_lls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.40, soc_rate = 0.1)
mg2014_lls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.24, soc_rate = 0.05)
carbonTable <- rbind(mg2000_hls, mg2000_mls, mg2000_lls,
mg2014_hls, mg2014_mls, mg2014_lls,
mg2014_hgn, mg2014_mgn, mg2014_lgn,
mg2014_hls_hgn, mg2014_hls_mgn, mg2014_hls_lgn,
mg2014_mls_hgn, mg2014_mls_mgn, mg2014_mls_lgn,
mg2014_lls_hgn, mg2014_lls_mgn, mg2014_lls_lgn) %>%
as.data.frame() %>%
mutate(year = c(rep("2000", 3), rep("2014", 15)),
loss = c(rep(c("hgh", "med", "low"), 3), rep("hgh", 3), rep("med", 3), rep("low", 3)),
gain = c(rep(NA, 3), rep(NA, 3), rep(c("hgh", "med", "low"), 4))) %>%
mutate(ttl = (aqua_c + agri_c + abnd_c + salt_c + urbn_c) / 1000000,
ttl_sd = (aqua_c_sd + agri_c_sd + abnd_c_sd + salt_c_sd + urbn_c_sd) / 1000000)
carbonTable
mg2014_gn
mean(mg2014_gn$SOC_AVG)
