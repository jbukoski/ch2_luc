library(raster)
library(rasterVis)
library(tidyverse)
proc_dir <- "./data/processed/"
scratch_dir <- "./data/scratch/"
raw_dir <- "./data/raw/"
dat <- read_csv(paste0(scratch_dir, "extent_estimates.csv"))
dat
ggplot(dat, aes(x = Year, y = Extent_ha)) +
geom_bar(aes(fill = as.factor(Reference)), stat = "identity",
position = position_dodge2(width = 10000, preserve = "single")) +
stat_smooth() +
theme_bw() +
ylab("Extent of Mangroves (ha)") +
labs(fill = "Source") +
theme(legend.position = "bottom")
r <- raster(paste0(proc_dir, "rasters/mg2000.tif"))
?levelplot
levelplot(r, margin = F)
gadm_sea <- st_read(paste0(raw_dir, "shapefiles/gadm_se_asia.shp"))
library(ggmap)
library(ggpubr)
library(grid)
library(gridExtra)
library(ggthemes)
library(raster)
library(rasterVis)
library(tidyverse)
library(sf)
gadm_sea <- st_read(paste0(raw_dir, "shapefiles/gadm_se_asia.shp"))
gadm_sea <- st_read(paste0(raw_dir, "shapefiles/gadm_se_asia.shp"))
library(ggmap)
library(ggpubr)
library(grid)
library(gridExtra)
library(ggthemes)
library(raster)
library(rasterVis)
library(sf)
library(tidyverse)
proc_dir <- "./data/processed/"
scratch_dir <- "./data/scratch/"
raw_dir <- "./data/raw/"
gadm_sea <- st_read(paste0(raw_dir, "shapefiles/gadm_se_asia.shp"))
tha <- st_read(paste0(raw_dir, "shapefiles/gadm_se_asia.shp")) %>%
filter(NAME_0 == "Thailand")
r <- raster(paste0(proc_dir, "rasters/mg2000.tif"))
plot(gadm_sea)
plot(gadm_sea$GID_0, fill = NA)
plot(gadm_sea$GID_0)
plot(gadm_sea$GID_0)
plot(gadm_sea)
plot(gadm_sea$GID_0)
plot(gadm_sea$geometry)
levelplot(r, margin = F, add = T)
plot(gadm_sea$geometry, add = T)
gadm_sea <- st_read(paste0(raw_dir, "shapefiles/gadm_se_asia.shp")) %>%
as("Spatial")
levelplot(r, margin = F) +
layer(sp.polygons(gadm_sea))
levelplot(r, margin = F) +
layer(sp.polygons(gadm_sea)) +
layer(sp.polygons(tha))
levelplot(r, margin = F) +
layer(sp.polygons(gadm_sea, fill = "light grey"))
layer(sp.polygons(gadm_sea, fill = "light grey")) +
levelplot(r, margin = F)
levelplot(r, margin = F) +
layer(sp.polygons(gadm_sea, fill = "light grey"))
levelplot(r, margin = F) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.1))
levelplot(r, margin = F) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.2))
levelplot(r, margin = F) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.3))
levelplot(r, margin = T) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.3))
?levelplot
levelplot(r, margin = list(axis = T, FUN = "sum")) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.3))
filter_r2 <- mask(r, filter_r, maskvalue = 1)
filter_r <- r == 3
levelplot(r, margin = list(axis = T, FUN = "sum"), legend = F) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.3))
?levelplot
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.3))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
par.settings = list(panel.background = list(col = "skyblue"))) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.3))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
par.settings = list(panel.background = list(col = "skyblue"))) +
layer(sp.polygons(gadm_sea, fill = "white", alpha = 0.3))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
par.settings = list(panel.background = list(col = "skyblue"))) +
layer(sp.polygons(gadm_sea, fill = "white", alpha = 1))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
par.settings = list(panel.background = list(col = "skyblue", alpha = 0.1))) +
layer(sp.polygons(gadm_sea, fill = "white", alpha = 1))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
par.settings = list(panel.background = list(col = "light blue", alpha = 0.1))) +
layer(sp.polygons(gadm_sea, fill = "white", alpha = 1))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
par.settings = list(panel.background = list(col = "light blue", alpha = 0.1))) +
layer(sp.polygons(gadm_sea, fill = "white", alpha = 1))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
par.settings = list(panel.background = list(col = "light blue", alpha = 0.1))) +
layer(sp.polygons(gadm_sea, fill = "white", alpha = 1)) +
layer(r)
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F) +
layer(sp.polygons(gadm_sea, fill = "white", alpha = 1)) +
layer(r)
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F) +
layer(sp.polygons(gadm_sea, fill = "white", alpha = 1))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 1))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.2))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.3))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
xlab = NULL, ylab = NULL) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.3))
tha <- st_read(paste0(raw_dir, "shapefiles/gadm_se_asia.shp")) %>%
filter(NAME_0 == "Thailand") %>%
as("Spatial")
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
xlab = NULL, ylab = NULL) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.3)) +
layer(sp.polygons(tha, fill = "light grey", alpha = 0.1))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
xlab = NULL, ylab = NULL) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.2)) +
layer(sp.polygons(tha, fill = "light grey", alpha = 0.2))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
xlab = NULL, ylab = NULL) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.1)) +
layer(sp.polygons(tha, fill = "light grey", alpha = 0.2))
levelplot(r, margin = list(axis = T, FUN = "sum"), colorkey = F,
xlab = NULL, ylab = NULL) +
layer(sp.polygons(gadm_sea, fill = "light grey", alpha = 0.2)) +
layer(sp.polygons(tha, fill = "light grey", alpha = 0.2))
1500 + 0.01 * 70,700
1500 + 0.01 * 70700
1500 + 0.001 * 70700 +
1
1500 + 0.001 * 70700 _ 0.001 * 54500
1500 + 0.001 * 70700 + 0.001 * 54500
1500 + 0.1 * 70700 + 0.1 * 54500
mg2014 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
mg2014 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
dstrcts_c_df
mg2014 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014
mg2014 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
select(ADM1_EN, ADM2_ID, ADM2_EN, aqucltr, agrcltr, abandnd,
AGB_AVG, AGB_SD, SOC_AVG, SOC_SD)
mg2014
df %>%
mutate(aqultr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd = abandnd)
df_rstr <- df %>%
mutate(aqultr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG)
calcRestorationCarbon <- function(df, rstr_rate, agb_rate, soc_rate) {
df_rstr <- df %>%
mutate(aqultr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG)
}
df_rstr <- df %>%
mutate(aqultr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG) %>%
select(total, agb_rstr, soc_rstr)
calcRestorationCarbon <- function(df, rstr_rate, agb_rate, soc_rate) {
df_rstr <- df %>%
mutate(aqultr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG) %>%
select(total, agb_rstr, soc_rstr)
ttls <- colSums(df_rstr, na.rm = T)
ttl <- sum(ttls)
return(ttl)
}
calcRestorationCarbon(mg2014_rstr, 0.001, 0.56, 0.10)
mg2014_rstr <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
select(ADM1_EN, ADM2_ID, ADM2_EN, aqucltr, agrcltr, abandnd,
AGB_AVG, AGB_SD, SOC_AVG, SOC_SD)
calcRestorationCarbon <- function(df, rstr_rate, agb_rate, soc_rate) {
df_rstr <- df %>%
mutate(aqultr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG) %>%
select(total, agb_rstr, soc_rstr)
ttls <- colSums(df_rstr, na.rm = T)
ttl <- sum(ttls)
return(ttl)
}
calcRestorationCarbon(mg2014_rstr, 0.001, 0.56, 0.10)
calcRestorationCarbon <- function(df, rstr_rate, agb_rate, soc_rate) {
df_rstr <- df %>%
mutate(aqucltr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG) %>%
select(total, agb_rstr, soc_rstr)
ttls <- colSums(df_rstr, na.rm = T)
ttl <- sum(ttls)
return(ttl)
}
calcRestorationCarbon(mg2014_rstr, 0.001, 0.56, 0.10)
calcRestorationCarbon(mg2014_rstr, 0.01, 0.56, 0.10)
calcRestorationCarbon(mg2014_rstr, 0.02, 0.56, 0.10)
calcRestorationCarbon(mg2014_rstr, 0.05, 0.56, 0.10)
calcRestorationCarbon(mg2014_rstr, 0.1, 0.56, 0.10)
calcRestorationCarbon(mg2014_rstr, 0.001, 1, 0.19)
calcRestorationCarbon(mg2014_rstr, 0.01, 1, 0.19)
calcRestorationCarbon(mg2014_rstr, 0.02, 1, 0.19)
calcRestorationCarbon(mg2014_rstr, 0.05, 1, 0.19)
calcRestorationCarbon(mg2014_rstr, 0.1, 1, 0.19)
calcRestorationCarbon(mg2014_rstr, 0.001, 0.35, 0.05)
calcRestorationCarbon(mg2014_rstr, 0.01, 0.35, 0.05)
calcRestorationCarbon(mg2014_rstr, 0.02, 0.35, 0.05)
calcRestorationCarbon(mg2014_rstr, 0.05, 0.35, 0.05)
calcRestorationCarbon(mg2014_rstr, 0.1, 0.35, 0.05)
1500 + 0.001 * (70700 + 54500)
1500 + 0.1 * (70700 + 54500)
dat <- data.frame(yr = yr, agb = agb)
yr <- c(0, 10, 20, 30, 40, 50, 60)
agb <- c(0, 45, 75, 125, 145, 144, 143)
dat <- data.frame(yr = yr, agb = agb)
plot(yr, agb)
agb <- c(0, 45, 75, 125, 140, 140, 140)
dat <- data.frame(yr = yr, agb = agb)
yr <- c(0, 10, 20, 30, 40, 50, 60)
agb <- c(0, 45, 75, 125, 140, 140, 140)
plot(yr, agb)
agb <- c(0, 45, 90, 125, 140, 140, 140)
plot(yr, agb)
exp(1)
nls(dat$agb ~ a / (1 + b * exp(1)^(-k*dat$yr), start = list(a = 140, b = 2, -k = 0.1) ))
nls(dat$agb ~ a / (1 + b * exp(1)^(-k*dat$yr)), start = list(a = 140, b = 2, -k = 0.1) )
nls(dat$agb ~ a / (1 + b * exp(1)^(-k*dat$yr)), start=list(a=140, b=2, k=0.1) )
142.5455 + 13.2424 * exp(1) ^ (-0.1447 * yr)
142.5455 / 1 + 13.2424 * exp(1) ^ (-0.1447 * yr)
142.5455 / (1 + 13.2424 * exp(1) ^ (-0.1447 * yr))
dat$pred <- 142.5455 / (1 + 13.2424 * exp(1) ^ (-0.1447 * yr))
plot(dat$yr, dat$pred)
plot(dat$yr, dat$agb, add = T)
plot(dat$yr, dat$agb)
plot(dat$yr, dat$agb)
plot(dat$yr, dat$agb, col = "red")
plot(dat$yr, dat$pred, add = TRUE)
142.5455 + 13.2424 * exp(1) ^ (-0.1447 * 15)
142.5455 / (1+ 13.2424 * exp(1) ^ (-0.1447 * 15) )
56.76 / 140
142.5455 / (1+ 13.2424 * exp(1) ^ (-0.1447 * 25) )
105/ 140
nls(dat$agb ~ a + b * ln(dat$yr), start=list(a=0, b = 1) )
nls(dat$agb ~ a + b * log(dat$yr), start=list(a=0, b = 1) )
log(10)
2 * log(10)
15 * log(10)
15 * log(20)
plot(yr, log(yr, base = exp(1)))
nls(dat$agb ~ a + b * log(dat$yr), start=list(a = 5, b = 1) )
model <- nls(dat$agb ~ a / (1 + b * exp(1) ^ (-k * dat$yr)), start=list(a = 5, b = 1) )
model <- nls(dat$agb ~ a / (1 + b * exp(1) ^ (-k * dat$yr)), start=list(a = 140, b = 13, k = 0.1) )
model <- nls(dat$agb ~ a / (1 + b * exp(1) ^ (-k * dat$yr)), start=list(a = 140, b = 13, k = 0.1) )
plot(yr, log(yr, base = exp(1)))model
model
(142.5455 / (1+ 13.2424 * exp(1) ^ (-0.1447 * 15) ) / 140 ) * 100
(142.5455 / (1+ 13.2424 * exp(1) ^ (-0.1447 * 25) ) / 140 ) * 100
(142.5455 / (1+ 13.2424 * exp(1) ^ (-0.1447 * 40) ) / 140 ) * 100
(142.5455 / (1 + 13.2424 * exp(1) ^ (-0.1447 * 15) )) / 140  * 100
(142.5455 / (1 + 13.2424 * exp(1) ^ (-0.1447 * 15) )) / 140  * 100
(142.5455 / (1 + 13.2424 * exp(1) ^ (-0.1447 * 25) )) / 140 * 100
(142.5455 / (1 + 13.2424 * exp(1) ^ (-0.1447 * 40) )) / 140 * 100
yr <- c(0, 10, 20, 30, 40, 50, 60)
agb <- c(0, 45, 90, 125, 140, 140, 140)
dat <- data.frame(yr = yr, agb = agb)
model <- nls(dat$agb ~ a / (1 + b * exp(1) ^ (-k * dat$yr)), start=list(a = 140, b = 13, k = 0.1) )
(142.5455 / (1 + 13.2424 * exp(1) ^ (-0.1447 * 15) )) / 140  * 100
(142.5455 / (1 + 13.2424 * exp(1) ^ (-0.1447 * 25) )) / 140 * 100
(142.5455 / (1 + 13.2424 * exp(1) ^ (-0.1447 * 40) )) / 140 * 100
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
mg2014_rstr <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
select(ADM1_EN, ADM2_ID, ADM2_EN, aqucltr, agrcltr, abandnd,
AGB_AVG, AGB_SD, SOC_AVG, SOC_SD)
calcRestorationCarbon <- function(df, rstr_rate, agb_rate, soc_rate) {
df_rstr <- df %>%
mutate(aqucltr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG) %>%
select(total, agb_rstr, soc_rstr)
ttls <- colSums(df_rstr, na.rm = T)
ttl <- sum(ttls)
return(ttl)
}
agb <- 0.98
soc <- 0.19
calcRestorationCarbon(mg2014_rstr, 0.001, agb, soc)
library(tidyverse)
calcRestorationCarbon(mg2014_rstr, 0.001, agb, soc)
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
library(sf)
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
library(gdalUtils)
library(gdata)
library(ggpubr)
library(ggthemes)
library(gridExtra)
library(raster)
library(rgdal)
library(sf)
library(sp)
library(spsurvey)
library(tidyverse)
raw_dir <- "./data/raw/"
proc_dir <- "./data/processed/"
scratch_dir <- "./data/scratch/"
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
mg2014_rstr <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
select(ADM1_EN, ADM2_ID, ADM2_EN, aqucltr, agrcltr, abandnd,
AGB_AVG, AGB_SD, SOC_AVG, SOC_SD)
df_rstr <- df %>%
mutate(aqucltr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG) %>%
dplyr::select(total, agb_rstr, soc_rstr)
calcRestorationCarbon <- function(df, rstr_rate, agb_rate, soc_rate) {
df_rstr <- df %>%
mutate(aqucltr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG) %>%
dplyr::select(total, agb_rstr, soc_rstr)
ttls <- colSums(df_rstr, na.rm = T)
ttl <- sum(ttls)
return(ttl)
}
agb <- 0.98
soc <- 0.19
calcRestorationCarbon(mg2014_rstr, 0.001, agb, soc)
mg2014_rstr <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
dplyr::select(ADM1_EN, ADM2_ID, ADM2_EN, aqucltr, agrcltr, abandnd,
AGB_AVG, AGB_SD, SOC_AVG, SOC_SD)
calcRestorationCarbon <- function(df, rstr_rate, agb_rate, soc_rate) {
df_rstr <- df %>%
mutate(aqucltr_rstr = aqucltr * rstr_rate,
agrcltr_rstr = agrcltr * rstr_rate,
abandnd_rstr = abandnd) %>%
rowwise() %>%
mutate(total = aqucltr_rstr + agrcltr_rstr + abandnd_rstr) %>%
ungroup() %>%
mutate(agb_rstr = total * agb_rate * AGB_AVG,
soc_rstr = total * soc_rate * SOC_AVG) %>%
dplyr::select(total, agb_rstr, soc_rstr)
ttls <- colSums(df_rstr, na.rm = T)
ttl <- sum(ttls)
return(ttl)
}
agb <- 0.98
soc <- 0.19
calcRestorationCarbon(mg2014_rstr, 0.001, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.01, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.02, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.05, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.1, agb, soc)
agb <- 0.75
soc <- 0.10
calcRestorationCarbon(mg2014_rstr, 0.001, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.01, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.02, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.05, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.1, agb, soc)
agb <- 0.41
soc <- 0.05
calcRestorationCarbon(mg2014_rstr, 0.001, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.01, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.02, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.05, agb, soc)
calcRestorationCarbon(mg2014_rstr, 0.1, agb, soc)
dstrcts_c_df <- st_read(paste0(proc_dir, "shapefiles/dstrcts_c/")) %>%
st_set_geometry(NULL)
mg2000 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2000")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014 <- st_read(paste0(proc_dir, "shapefiles/dstrct_ttls_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
mg2014_ls <- st_read(paste0(proc_dir, "shapefiles/dstrct_losses_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID")) %>%
mutate(mines = NA)
mg2014_gn <- st_read(paste0(proc_dir, "shapefiles/dstrct_gains_2014")) %>%
left_join(dstrcts_c_df, by = c("ADM2_EN", "ADM1_EN", "ADM2_ID"))
calcCarbon <- function(sf_obj, agb_rate, soc_rate) {
df <- sf_obj %>%
mutate(aqua_c = (aqucltr * AGB_AVG * agb_rate) + (aqucltr * SOC_AVG * soc_rate),
agri_c = (agrcltr * AGB_AVG * agb_rate) + (agrcltr * SOC_AVG * soc_rate),
mine_c = (mines * AGB_AVG * agb_rate) + (mines * SOC_AVG * soc_rate),
abnd_c = (abandnd * AGB_AVG * agb_rate) + (abandnd * SOC_AVG * soc_rate),
salt_c = (slt_frm * AGB_AVG * agb_rate) + (slt_frm * SOC_AVG * soc_rate),
urbn_c = (urban * AGB_AVG * agb_rate) + (urban * SOC_AVG * soc_rate)) %>%
st_set_geometry(NULL) %>%
dplyr::select(aqua_c, agri_c, mine_c, abnd_c, salt_c, urbn_c)
ttls <- colSums(df, na.rm = T)
ttl <- sum(ttls)
return(ttls)
}
calcCarbon(mg2014_gn, agb_rate = 0.98, soc_rate = 0.19)
sum(calcCarbon(mg2014_gn, agb_rate = 0.98, soc_rate = 0.19)) / 1000000
sum(calcCarbon(mg2014_gn, agb_rate = 0.75, soc_rate = 0.10)) / 1000000
sum(calcCarbon(mg2014_gn, agb_rate = 0.41, soc_rate = 0.05)) / 1000000
mg2014_hls_hgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.98, soc_rate = 0.19)
mg2014_hls_mgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.75, soc_rate = 0.1)
mg2014_hls_lgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.41, soc_rate = 0.05)
mg2014_mls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.98, soc_rate = 0.19)
mg2014_mls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.75, soc_rate = 0.1)
mg2014_mls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.41, soc_rate = 0.05)
mg2014_lls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.98, soc_rate = 0.19)
mg2014_lls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.75, soc_rate = 0.1)
mg2014_lls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.41, soc_rate = 0.05)
carbonTable <- rbind(mg2000_hls, mg2000_mls, mg2000_lls,
mg2014_hls_hgn, mg2014_hls_mgn, mg2014_hls_lgn,
mg2014_mls_hgn, mg2014_mls_mgn, mg2014_mls_lgn,
mg2014_lls_hgn, mg2014_lls_mgn, mg2014_lls_lgn) %>%
as.data.frame() %>%
mutate(year = c(rep("2000", 3), rep("2014", 9)),
loss = c("hgh", "med", "low", rep("hgh", 3), rep("med", 3), rep("low", 3)),
gain = c(rep(NA, 3), rep(c("hgh", "med", "low"), 3)))
mg2000_hls <- calcCarbon(mg2000, agb_rate = 1, soc_rate = 0.67)
mg2000_mls <- calcCarbon(mg2000, agb_rate = 0.82, soc_rate = 0.54)
mg2000_lls <- calcCarbon(mg2000, agb_rate = 0.47, soc_rate = 0.41)
mg2014_hls_hgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.98, soc_rate = 0.19)
mg2014_hls_mgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.75, soc_rate = 0.1)
mg2014_hls_lgn <- calcCarbon(mg2014_ls, agb_rate = 1, soc_rate = 0.67) - calcCarbon(mg2014_gn, agb_rate = 0.41, soc_rate = 0.05)
mg2014_mls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.98, soc_rate = 0.19)
mg2014_mls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.75, soc_rate = 0.1)
mg2014_mls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.82, soc_rate = 0.54) - calcCarbon(mg2014_gn, agb_rate = 0.41, soc_rate = 0.05)
mg2014_lls_hgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.98, soc_rate = 0.19)
mg2014_lls_mgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.75, soc_rate = 0.1)
mg2014_lls_lgn <- calcCarbon(mg2014_ls, agb_rate = 0.47, soc_rate = 0.41) - calcCarbon(mg2014_gn, agb_rate = 0.41, soc_rate = 0.05)
carbonTable <- rbind(mg2000_hls, mg2000_mls, mg2000_lls,
mg2014_hls_hgn, mg2014_hls_mgn, mg2014_hls_lgn,
mg2014_mls_hgn, mg2014_mls_mgn, mg2014_mls_lgn,
mg2014_lls_hgn, mg2014_lls_mgn, mg2014_lls_lgn) %>%
as.data.frame() %>%
mutate(year = c(rep("2000", 3), rep("2014", 9)),
loss = c("hgh", "med", "low", rep("hgh", 3), rep("med", 3), rep("low", 3)),
gain = c(rep(NA, 3), rep(c("hgh", "med", "low"), 3)))
carbonTable
