fig4 <- dat2plt %>%
ggplot() +
facet_wrap(. ~ loss, ncol = 3) +
geom_bar(aes(x = gain, y = ttl, fill = loss), alpha = 0.8, width = 0.7, stat = "identity") +
geom_errorbar(aes(x = gain, ymin = ttl - ttl_sd, ymax = ttl + ttl_sd, col = loss), alpha = 0.8, width = .2, position = position_dodge(.9)) +
ylab("Total Emissions, 2000-2014 (Million Mg C)") +
xlab("Rate of C Stock Gain") +
scale_fill_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
scale_color_manual(values = c("Low Rate of C Stock Loss" = "#56B4E9", "Medium Rate of C Stock Loss" = "#009E73", "High Rate of C Stock Loss" = "#0072B2")) +
geom_hline(aes(yintercept = avg_ttl, col = loss), linetype = "longdash") +
geom_hline(aes(yintercept = net_ttl), col = "#999999", linetype = "dashed") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
legend.position = "none",
legend.title = element_blank(),
title = element_text(size = 10),
axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
axis.title.y = element_text(margin=margin(0, 0, 0, 5)))
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .2, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
guides(linetype = "none",
alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
ggsave("./figs/fig4_growth.jpg", growthMdl, width = 8, height = 5, units = c("in"), device = "jpeg")
dat <- read_xlsx("./data/raw/sigit_data.xlsx") %>%
dplyr::select(dataset_variable, yr = "regeneration age", agb = mean) %>%
filter(dataset_variable == "Aboveground biomass carbon stock") %>%
as.data.frame()
prop_df <- read_csv("./data/processed/eq1_mdlRuns.csv")
growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
ggsave("./figs/fig4_growth.jpg", growthMdl, width = 8, height = 5, units = c("in"), device = "jpeg")
ggsave("./figs/fig2_growth.jpg", growthMdl, width = 8, height = 5, units = c("in"), device = "jpeg")
growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
ggsave("./figs/fig2_growth.jpg", growthMdl, width = 8, height = 5, units = c("in"), device = "jpeg")
dat2000 <- read_csv("./data/processed/allPrdsSmry.csv")
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .2, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
guides(linetype = "none",
alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
ggsave("./figs/fig3_stocks.jpg", fig4, width = 4, height = 8, units = c("in"), device = "jpeg")
ggsave("./figs/fig3_stocks.jpg", fig3, width = 4, height = 8, units = c("in"), device = "jpeg")
ggsave("./figs/fig3_stocks.jpg", fig3, width = 4, height = 6, units = c("in"), device = "jpeg")
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .2, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
#guides(linetype = "none", alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .2, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net C Stock Change" = "#A44294", "C Stock Gains" = "#44AA99", "C Stock Losses" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
#guides(linetype = "none", alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
fig3 <- dat2000 %>%
ggplot() +
geom_hline(aes(yintercept = 0), color = "grey", linetype = "dashed") +
geom_errorbar(aes(x = year, ymin = carbon + error, ymax = carbon - 1 * (error / abs(error)),
col = factor(style, levels = c("Loss", "Gain" , "Net"))),
width = .2, alpha = 0.8) +
geom_bar(aes(x = year, y = carbon, fill = factor(style, levels = c("Loss", "Gain", "Net"))),
stat = "identity", width = 0.6, alpha = 1) +
scale_fill_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
scale_color_manual(values = c("Net" = "#A44294", "Gain" = "#44AA99", "Loss" = "#117733")) +
labs(y = "Total Emissions (Million Mg C)") +
#ggtitle("A. Total & Net Carbon Emissions") +
xlab("Time Period & Estimation Approach") +
#guides(linetype = "none", alpha = "none") +
theme_bw() +
guides(color = guide_legend(override.aes = list(color = NA))) +
theme(axis.title.x = element_text(margin=margin(15, 0, 0, 0)),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
strip.background = element_blank(),
title = element_text(size = 10),
strip.text = element_text(" "),
legend.title = element_blank(),
legend.position = c(0.8, 0.2),
legend.direction = "vertical")
fig3
growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
geom_annotate(aes(x = 16, y = 40, label = "t = 14"), col = "red") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
?geom_annotate
??geom_annotate
growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate(aes(x = 16, y = 40, label = "t = 14"), col = "red") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 16, y = 40, label = "t = 14", col = "red") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
fig3_growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 16, y = 40, label = "t = 14", col = "red") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
fig3_growthMdl
fig3_growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 20, y = 225, label = "t = 14", col = "red") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
fig3
fig3_growthMdl
fig3_growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 10, y = 225, label = "t = 14", col = "red") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
fig3_growthMdl
fig3_growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 17, y = 225, label = "t = 14", col = "red") +
geom_vline(xintercept = 14,linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
fig3_growthMdl
fig3_growthMdl <- ggplot(dat, aes(yr, agb)) +
geom_point(color = "dark grey") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = dat,
se = FALSE,
color = "black") +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = lwr)) +
geom_smooth(method = "nls",
method.args = list(formula = y ~ a / (1 + b * exp(1) ^ (-k * x)),
start = list(a = 140, b = 13, k = 0.1)),
data = prop_df,
se = FALSE,
color = "black",
linetype = "dashed",
aes(x = yr, y = upr)) +
ylab("AGC (Mg / ha)") +
xlab("Time Since Regeneration (Years)") +
annotate("text", x = 18, y = 225, label = "t = 14", col = "red") +
geom_vline(xintercept = 14, linetype = "dashed", color = "red") +
theme_tufte() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank())
fig3_growthMdl
ggsave("./figs/fig2_growth.jpg", fig3_growthMdl, width = 8, height = 5, units = c("in"), device = "jpeg")
